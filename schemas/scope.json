{
  "$comment": "Copyright 2025 Cory Parent - Licensed under the Apache License, Version 2.0",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://rhema.dev/schemas/v1/scope",
  "title": "Rhema Scope Definition",
  "description": "Defines the boundaries and purpose of a Rhema context scope",
  "type": "object",
  "required": ["rhema"],
  "properties": {
    "rhema": {
      "type": "object",
      "required": ["version", "scope"],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Rhema protocol version"
        },
        "scope": {
          "type": "object",
          "required": ["type", "name", "description"],
          "properties": {
            "type": {
              "type": "string",
              "enum": ["repository", "service", "application", "library", "component"],
              "description": "Type of scope this context represents"
            },
            "name": {
              "type": "string",
              "description": "Human-readable name for this scope"
            },
            "description": {
              "type": "string",
              "description": "Detailed description of scope purpose and responsibilities"
            },
            "boundaries": {
              "type": "object",
              "properties": {
                "includes": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "File patterns included in this scope"
                },
                "excludes": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "File patterns excluded from this scope"
                }
              }
            },
            "dependencies": {
              "type": "object",
              "properties": {
                "parent": {
                  "type": "string",
                  "description": "Path to parent scope"
                },
                "children": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Paths to child scopes"
                },
                "peers": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Paths to peer scopes this scope collaborates with"
                }
              }
            },
            "responsibilities": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of responsibilities this scope handles"
            },
            "tech": {
              "type": "object",
              "properties": {
                "primary_languages": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "frameworks": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "databases": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            },
            "locomo_metrics": {
              "type": "object",
              "description": "LOCOMO performance metrics for this scope",
              "properties": {
                "context_retrieval": {
                  "type": "object",
                  "properties": {
                    "average_latency_ms": {
                      "type": "number",
                      "description": "Average context retrieval latency in milliseconds"
                    },
                    "success_rate": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Context retrieval success rate"
                    },
                    "relevance_score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Context relevance score"
                    },
                    "coverage_score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Context coverage score"
                    }
                  }
                },
                "context_compression": {
                  "type": "object",
                  "properties": {
                    "compression_ratio": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Context compression ratio"
                    },
                    "quality_preservation": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Quality preservation during compression"
                    },
                    "compression_speed_ms": {
                      "type": "number",
                      "description": "Compression speed in milliseconds"
                    }
                  }
                },
                "ai_optimization": {
                  "type": "object",
                  "properties": {
                    "token_reduction_percentage": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Token reduction percentage"
                    },
                    "quality_improvement": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Quality improvement score"
                    },
                    "optimization_speed_ms": {
                      "type": "number",
                      "description": "Optimization speed in milliseconds"
                    }
                  }
                },
                "quality_assessment": {
                  "type": "object",
                  "properties": {
                    "overall_quality_score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Overall quality score"
                    },
                    "relevance_score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Relevance score"
                    },
                    "completeness_score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Completeness score"
                    },
                    "accuracy_score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Accuracy score"
                    }
                  }
                },
                "validation_metrics": {
                  "type": "object",
                  "properties": {
                    "total_validations": {
                      "type": "integer",
                      "minimum": 0,
                      "description": "Total number of validations"
                    },
                    "passed_validations": {
                      "type": "integer",
                      "minimum": 0,
                      "description": "Number of passed validations"
                    },
                    "failed_validations": {
                      "type": "integer",
                      "minimum": 0,
                      "description": "Number of failed validations"
                    },
                    "success_rate": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1,
                      "description": "Validation success rate"
                    }
                  }
                }
              }
            }
          }
        },
        "tooling": {
          "type": "object",
          "properties": {
            "focus_areas": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Areas AI agents should focus on in this scope"
            },
            "recommended_analysis": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Types of analysis recommended for this scope"
            }
          }
        }
      }
    }
  },
  "additionalProperties": true
}
